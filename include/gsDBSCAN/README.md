I've broken down gsDBSCAN into 3 parts:
1. Preprocessing
2. Distance calculations
3. Clustering

There is also a utils file that contains helper functions for the above 3 parts.